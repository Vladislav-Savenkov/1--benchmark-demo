// Процедура загрузки видов оборудования из CSV-файла
// Весь код написан на русском языке, с комментариями

Процедура ЗагрузитьВидыОборудования()

    // Открываем диалог выбора файла
    Файл = ДиалогВыбораФайла();
    Если Файл = Неопределено Тогда
        Сообщить("Файл не выбран.");
        Возврат;
    КонецЕсли;

    // Читаем содержимое файла
    ТаблицаДанных = Новый ТаблицаЗначений;
    ТаблицаДанных.Колонки.Добавить("Код");
    ТаблицаДанных.Колонки.Добавить("Наименование");
    ТаблицаДанных.Колонки.Добавить("Описание");

    Поток = Новый ТекстовыйДокумент;
    Поток.Прочитать(Файл);
    Строки = СтрРазделить(Поток.ПолучитьТекст(), Символы.ПС);

    Для Каждого Строка Из Строки Цикл
        Если Строка = "" Тогда
            Продолжить;
        КонецЕсли;
        Данные = СтрРазделить(Строка, ",");
        Если Данные.Количество < 3 Тогда
            Продолжить;
        КонецЕсли;
        НоваяСтрока = ТаблицаДанных.Добавить();
        НоваяСтрока.Код = Данные[0];
        НоваяСтрока.Наименование = Данные[1];
        НоваяСтрока.Описание = Данные[2];
    КонецЦикла;

    // Импорт данных в справочник
    Для Каждого Строка Из ТаблицаДанных Цикл
        Элемент = Справочники.ВидыОборудования.НайтиПоКоду(Строка.Код);
        Если Элемент = Неопределено Тогда
            Элемент = Справочники.ВидыОборудования.СоздатьЭлемент();
            Элемент.Код = Строка.Код;
        КонецЕсли;
        Элемент.Наименование = Строка.Наименование;
        Элемент.Описание = Строка.Описание;
        Элемент.Записать();
    КонецЦикла;

    Сообщить("Загрузка завершена успешно.");

КонецПроцедуры

// Вспомогательная функция для выбора файла
Функция ДиалогВыбораФайла()
    Диалог = Новый ДиалогВыбораФайла;
    Диалог.Заголовок = "Выберите CSV-файл";
    Диалог.Фильтр = "CSV файлы (*.csv)|*.csv";
    Если Диалог.Выбрать() Тогда
        Возврат Диалог.ПолноеИмяФайла;
    Иначе
        Возврат Неопределено;
    КонецЕсли;
КонецФункции
